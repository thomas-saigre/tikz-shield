%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is the TikZbricks package
% A package to draw bricks with tikz
% Maintained by thomas-saigre
%
% Project repository and bug tracker:
% https://github.com/thomas-saigre/tikz-shield
%
% Released under the GNU GENERAL PUBLIC LICENSE v3
% See https://github.com/thomas-saigre/tikz-shield/blob/main/LICENSE
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ProvidesPackage{tikz-shield}[2025/05/12 version v0.1 Drawing badges with TikZ]

\RequirePackage{tikz}
\RequirePackage{fontawesome}
\RequirePackage{hyperref}
\RequirePackage[most]{tcolorbox}
\RequirePackage{xkeyval}

\DeclareOptionX{font}[\sf]{\def\shield@default@font{#1}}
\DeclareOptionX{colorLeft}[default-left]{\def\shield@default@colorLeft{#1}}
\DeclareOptionX{colorRight}[default-blue]{\def\shield@default@colorRight{#1}}

\definecolor{default-blue}{HTML}{1283c4}
\definecolor{default-left}{HTML}{5e5e5e}

\ExecuteOptionsX{font}
\ExecuteOptionsX{colorLeft}
\ExecuteOptionsX{colorRight}


\define@key{badge}{colorLeft}{\def\badge@colorLeft{#1}}
\define@key{badge}{colorRight}{\def\badge@colorRight{#1}}
\define@key{badge}{logo}{\def\badge@logo{#1}}

\ProcessOptionsX

% Creation of a dropped shadow
\newcommand{\droptextshadow}[2]{%
    \tikz[baseline,outer sep=0pt, inner sep=0pt]{
    % Dropped Shadow
    \node[#1!40!black] at (0,-0.1ex) {#2};
    % Text
    \node[white] at (0,0) {#2};
}%
}



% Draw a badge
% #1 Default options
% #2 Left text
% #3 Right text
\newcommand{\drawBadge}[3][]{
    \def\badge@colorLeft{\shield@default@colorLeft}
    \def\badge@colorRight{\shield@default@colorRight}
    \def\badge@logo{}
    %
    \setkeys{badge}{#1}
    %
    \mbox{
    \hspace{-2ex}
    \tcbsidebyside[
        bicolor, sidebyside,
        sidebyside adapt=both,
        sidebyside gap=5pt,
        top=0pt, left=0pt, right=0pt, bottom=0pt,
        boxrule=0pt, rounded corners,
        interior style={top color=\badge@colorLeft, bottom color=\badge@colorLeft!60!black},
        segmentation style={top color=\badge@colorRight, bottom color=\badge@colorRight!60!black},
    ]{  % Left bloc
        \shield@default@font
        \ifx\badge@logo\@empty
            \droptextshadow{default-left}{#2}
        \else
            \droptextshadow{default-left}{\badge@logo\ #2}
        \fi
    }{  % Right bloc
        \shield@default@font
        \droptextshadow{\badge@colorRight}{#3}
    }
    \hspace{-2ex}
    }
}


\newcommand{\githubBadge}[2][]
{
    {%
    \hypersetup{hidelinks}%
    \mbox{\href{https://github.com/#2}{\mbox{\hspace{-0.5ex}}\drawBadge[#1, logo=\faGithub]{}{github.com/#2}}\hspace{-1ex}}%
    }
}

\newcommand{\gitlabBadge}[2][]
{
    {%
    \hypersetup{hidelinks}%
    \mbox{\href{https://gitlab.com/#2}{\mbox{\hspace{-0.5ex}}\drawBadge[#1, logo=\faGitlab]{}{gitlab.com/#2}}\hspace{-1ex}}%
    }
}

\newcommand{\forgeBadge}[2][]
{
    {%
    \hypersetup{hidelinks}%
    \mbox{\href{https://#2}{\mbox{\hspace{-0.5ex}}\drawBadge[#1]{}{gitlab.com/#2}}\hspace{-1ex}}%
    }
}
